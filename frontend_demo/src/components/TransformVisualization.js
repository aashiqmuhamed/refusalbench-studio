import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import DiffText from '@/components/DiffText';
const formatAnswers = (answers) => {
    if (!answers) {
        return 'Not provided';
    }
    return Array.isArray(answers) ? answers.join(', ') : answers;
};
const TransformVisualization = ({ data, loading = false, error, onVerify }) => {
    const hasResult = Boolean(data && data.generation_successful);
    const result = hasResult ? data : null;
    const hasData = Boolean(data);
    return (_jsxs("div", { className: "panel", children: [_jsx("header", { className: "panel__header", children: _jsx("div", { children: _jsx("h2", { className: "panel__title", children: "Perturbation Viewer" }) }) }), error && _jsx("div", { className: "panel__banner panel__banner--error", children: error }), loading && !result && _jsx("div", { className: "panel__banner", children: "Generating perturbation..." }), result ? (_jsxs(_Fragment, { children: [_jsxs("div", { className: "transform-panel", children: [_jsxs("article", { className: "transform-card", children: [_jsx("h3", { className: "transform-card__title", children: "Original Input" }), _jsxs("div", { className: "transform-card__section", children: [_jsx("span", { className: "transform-card__label", children: "Question" }), _jsx("p", { className: "transform-card__text", children: result.original_query })] }), _jsxs("div", { className: "transform-card__section", children: [_jsx("span", { className: "transform-card__label", children: "Context" }), _jsx("p", { className: "transform-card__text transform-card__text--context", children: result.original_context })] }), _jsxs("div", { className: "transform-card__section", children: [_jsx("span", { className: "transform-card__label", children: "Answer" }), _jsx("p", { className: "transform-card__text", children: formatAnswers(result.original_answers) })] })] }), _jsxs("article", { className: "transform-card transform-card--highlight", children: [_jsx("h3", { className: "transform-card__title", children: "Perturbed Output" }), _jsxs("div", { className: "transform-card__section", children: [_jsx("span", { className: "transform-card__label", children: "Perturbed question" }), _jsx(DiffText, { before: result.original_query, after: result.perturbed_query ?? result.original_query, className: "transform-card__text" })] }), _jsxs("div", { className: "transform-card__section", children: [_jsx("span", { className: "transform-card__label", children: "Perturbed context" }), _jsx(DiffText, { before: result.original_context, after: result.perturbed_context ?? result.original_context, className: "transform-card__text transform-card__text--context", as: "div" })] })] })] }), _jsxs("div", { className: "transform-meta", children: [_jsxs("div", { className: "transform-meta__item", children: [_jsx("span", { className: "transform-meta__label", children: "Class" }), _jsx("span", { className: "transform-meta__value", children: result.perturbation_class })] }), _jsxs("div", { className: "transform-meta__item", children: [_jsx("span", { className: "transform-meta__label", children: "Intensity" }), _jsx("span", { className: "transform-meta__value", children: result.intensity })] }), result.ground_truth_label && (_jsxs("div", { className: "transform-meta__item", children: [_jsx("span", { className: "transform-meta__label", children: "Expected Output (Ground Truth)" }), _jsx("span", { className: `transform-meta__value transform-meta__value--ground-truth ${result.ground_truth_label === 'ANSWER_CORRECTLY'
                                            ? 'transform-meta__value--answer'
                                            : 'transform-meta__value--refuse'}`, children: result.ground_truth_label })] })), result.generator_display_name && (_jsxs("div", { className: "transform-meta__item", children: [_jsx("span", { className: "transform-meta__label", children: "Generator Model" }), _jsx("span", { className: "transform-meta__value", children: result.generator_display_name })] })), result.lever_selected && (_jsxs("div", { className: "transform-meta__item transform-meta__item--wide", children: [_jsx("span", { className: "transform-meta__label", children: "Lever selected" }), _jsx("span", { className: "transform-meta__value", children: result.lever_selected })] })), result.implementation_reasoning && (_jsxs("div", { className: "transform-meta__item transform-meta__item--wide", children: [_jsx("span", { className: "transform-meta__label", children: "Implementation reasoning" }), _jsx("p", { className: "transform-meta__value", children: result.implementation_reasoning })] }))] })] })) : (!loading &&
                !error && (_jsx("div", { className: "panel__empty", children: _jsx("p", { children: "Submit a QA example to visualize perturbations." }) }))), onVerify && (_jsx("div", { style: { marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid var(--color-border)', display: 'flex', justifyContent: 'center', width: '100%' }, children: _jsx("button", { type: "button", className: "button button--primary", style: { cursor: 'pointer', width: 'auto', minWidth: '200px' }, onClick: onVerify, children: "Verify Perturbation \u2192" }) }))] }));
};
export default TransformVisualization;
